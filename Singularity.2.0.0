Bootstrap: shub
From: pndni/centos7-base:1.2.0

%post
    yum install -y epel-release
    yum install -y python36 python36-pip python36-devel libstdc++-static pigz

%appinstall heudiconv
    pip3.6 install virtualenv
    virtualenv /opt/heudiconv
    source /opt/heudiconv/bin/activate
    pip install heudiconv
    deactivate

%appenv heudiconv
    source ${SCIF_APPENV_dcm2niix}
    source /opt/heudiconv/bin/activate

%apprun heudiconv
    heudiconv "$@"

%appinstall dcm2niix
    git clone --branch v1.0.20181125 https://github.com/rordenlab/dcm2niix.git
    cd dcm2niix
    mkdir build && cd build
    /opt/cmake/bin/cmake -DCMAKE_INSTALL_PREFIX=/opt/dcm2niix ..
    make
    make install

%appenv dcm2niix
    export PATH=/opt/dcm2niix/bin:$PATH

%apprun dcm2niix
    dcm2niix "$@"

%labels
    Maintainer Steven Tilley
    Version 2.0.0

